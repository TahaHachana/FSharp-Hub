(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;$.Define($$,{IntelliFactory:{Formlet:{Base:{D:$.Class({Dispose:function(){return null;}},{New:function(){return $.New(this,{});}}),Form:$.Class({Dispose:function(){return this.Dispose1.call(null,null);}}),Formlet:$.Class({Build:function(){return this.Build1.call(null,null);},MapResult:function(q){var t=this;return $.New(c,{Layout:this.Layout,Build1:function(){var s;s=t.Build1.call(null,null);t.Utils.Reactive.Select(s.State,q);return $.New(d,{Body:s.Body,Dispose1:s.Dispose1,Notify:s.Notify,State:s.State});},Utils:t.Utils});},get_Layout:function(){return this.Layout;}}),FormletBuilder:$.Class({Bind:function(u,v){return this.F.Bind(u,v);},Delay:function(w){return this.F.Delay(w);},Return:function(x){return this.F.Return(x);},ReturnFrom:function(y){return y;}},{New:function(z){var A;A=$.New(this,{});A.F=z;return A;}}),FormletProvider:$.Class({AppendLayout:function(B,C){return this.WithLayout(B,this.ApplyLayout(C));},Apply:function(D,E){var H=this;return this.New(function(){var G,I,J,K;G=H.BuildForm(D);I=H.BuildForm(E);J=H.U.Reactive;K=G.Body;return $.New(d,{Body:H.U.Reactive.Merge(J.Select(K,function(L){return $.New(f,{$:1,$0:L});}),H.U.Reactive.Select(I.Body,function(M){return $.New(f,{$:2,$0:M});})),Dispose1:function(){I.Dispose1.call(null,null);return G.Dispose1.call(null,null);},Notify:function(O){I.Notify.call(null,O);return G.Notify.call(null,O);},State:H.U.Reactive.CombineLatest(I.State,G.State,function(P){return function(Q){return g.Apply(Q,P);};})});});},ApplyLayout:function(R){var V=this;return this.New(function(){var T,U;T=R.Build();U=R.get_Layout().Apply.call(null,T.Body);return $.New(d,{Body:U.$==0?T.Body:V.U.Reactive.Return(e.Set(U.$0[0])),Dispose1:T.Dispose1,Notify:T.Notify,State:T.State});});},Bind:function(W,X){return this.Join(this.Map(X,W));},BindWith:function(Y,Z,_0){var _3=this;return this.New(function(){var _2,_4,_5,_6,_8,_9,_,bb,bc,bd,be;_2=_3.Bind(Z,_0);_4=_2.Build();_5=_3.U.Reactive;_6=_5.Where(_4.Body,function(_7){return _7.$==1?true:false;});_8=_3.U.DefaultLayout.Apply.call(null,_6);_9=_3.U.Reactive;_=_9.Where(_4.Body,function(ba){return ba.$==2?true:false;});bb=_3.U.DefaultLayout.Apply.call(null,_);bc=[_8,bb];if(bc[0].$==1){if(bc[1].$==1){be=bc[1].$0[0];bd=_3.U.Reactive.Return(e.Set((Y(bc[0].$0[0]))(be)));}else{bd=_3.U.Reactive.Never();}}else{bd=_3.U.Reactive.Never();}return $.New(d,{Body:bd,Dispose1:_4.Dispose1,Notify:_4.Notify,State:_4.State});});},BuildForm:function(be){var bf,bg,bh;bf=be.Build();bg=be.get_Layout().Apply.call(null,bf.Body);if(bg.$==1){bh=bg.$0[1];return $.New(d,{Body:this.U.Reactive.Return(e.Set(bg.$0[0])),Dispose1:function(){bf.Dispose1.call(null,null);return bh.Dispose();},Notify:bf.Notify,State:bf.State});}else{return bf;}},Delay:function(bj){var bk,bm=this;bk=function(){return bm.BuildForm(bj(null));};return $.New(c,{Layout:bm.L.Delay(function(){return bj(null).get_Layout();}),Build1:bk,Utils:bm.U});},Deletable:function(bo){var bq=this;return this.Replace(bo,function(bp){return bp.$==1?bq.Return({$:1,$0:bp.$0}):bq.ReturnEmpty({$:0});});},Empty:function(){var bs=this;return this.New(function(){return $.New(d,{Body:bs.U.Reactive.Return(e.Delete()),Dispose1:function(){},Notify:function(){},State:bs.U.Reactive.Never()});});},EmptyForm:function(){return $.New(d,{Body:this.U.Reactive.Never(),Dispose1:function(){},Notify:function(){},State:this.U.Reactive.Never()});},Fail:function(bx){return $.New(d,{Body:this.U.Reactive.Never(),Dispose1:function(by){return by;},Notify:function(){},State:this.U.Reactive.Return($.New(g,{$:1,$0:bx}))});},FailWith:function(bA){var bC=this;return this.New(function(){return bC.Fail(bA);});},FlipBody:function(bD){var bE,bH=this;bE=this.New(function(){var bG;bG=bD.Build();return $.New(d,{Body:bH.U.Reactive.Select(bG.Body,function(bI){return e.FlipEdit(bI);}),Dispose1:bG.Dispose1,Notify:bG.Notify,State:bG.State});});return bH.WithLayout(bD.get_Layout(),bE);},FromState:function(bJ){var bL=this;return this.New(function(){return $.New(d,{Body:bL.U.Reactive.Never(),Dispose1:function(){},Notify:function(){},State:bJ});});},InitWith:function(bO,bP){var bQ,bU=this;bQ=this.New(function(){var bS,bT;bS=bP.Build();bT=bS.State;return $.New(d,{Body:bS.Body,Dispose1:bS.Dispose1,Notify:bS.Notify,State:bU.U.Reactive.Concat(bU.U.Reactive.Return($.New(g,{$:0,$0:bO})),bT)});});return bU.WithLayout(bP.get_Layout(),bQ);},InitWithFailure:function(bV){var bW,b0=this;bW=this.New(function(){var bY,bZ;bY=bV.Build();bZ=bY.State;return $.New(d,{Body:bY.Body,Dispose1:bY.Dispose1,Notify:bY.Notify,State:b0.U.Reactive.Concat(b0.U.Reactive.Return($.New(g,{$:1,$0:$.New(j,{$:0})})),bZ)});});return b0.WithLayout(bV.get_Layout(),bW);},Join:function(b1){var b4=this;return this.New(function(){var b3,b5,b6,b8,b9,b_,b$,cb;b3=b4.BuildForm(b1);b5=b4.U.Reactive;b6=b5.Select(b3.State,function(b7){return b7.$==1?b4.Fail(b7.$0):b4.BuildForm(b7.$0);});b8=b4.U.Reactive;b9=b8.Heat(b6);b_=b4.U.Reactive;b$=function(ca){return $.New(f,{$:2,$0:ca});};cb=b4.U.Reactive.Select(b4.U.Reactive.Switch(b_.Select(b9,function(cc){var cd;cd=cc.Body;return b4.U.Reactive.Concat(b4.U.Reactive.Return(e.Delete()),cd);})),b$);return $.New(d,{Body:b4.U.Reactive.Merge(b4.U.Reactive.Select(b3.Body,function(ce){return $.New(f,{$:1,$0:ce});}),cb),Dispose1:function(){return b3.Dispose1.call(null,null);},Notify:b3.Notify,State:b4.U.Reactive.Switch(b4.U.Reactive.Select(b9,function(cg){return cg.State;}))});});},LiftResult:function(ch){return this.MapResult(function(ci){return $.New(g,{$:0,$0:ci});},ch);},Map:function(cj,ck){return this.MapResult(function(cl){return g.Map(cj,cl);},ck);},MapBody:function(cm,cn){var cr=this;return this.WithLayout({Apply:function(co){var cp,cq,cs,ct;cp=cn.get_Layout().Apply.call(null,co);if(cp.$==0){cq=cr.U.DefaultLayout.Apply.call(null,co);if(cq.$==0){return{$:0};}else{cs=cq.$0[1];return{$:1,$0:[cm(cq.$0[0]),cs]};}}else{ct=cp.$0[1];return{$:1,$0:[cm(cp.$0[0]),ct]};}}},cn);},MapResult:function(cu,cv){var cw,cz=this;cw=function(){var cy;cy=cv.Build();return $.New(d,{Body:cy.Body,Dispose1:cy.Dispose1,Notify:cy.Notify,State:cz.U.Reactive.Select(cy.State,cu)});};return $.New(c,{Layout:cv.get_Layout(),Build1:cw,Utils:cz.U});},Never:function(){var cB=this;return this.New(function(){return $.New(d,{Body:cB.U.Reactive.Never(),Dispose1:function(){},Notify:function(){},State:cB.U.Reactive.Never()});});},New:function(cE){return $.New(c,{Layout:this.L.Default(),Build1:cE,Utils:this.U});},Replace:function(cF,cG){return this.Switch(this.Map(cG,cF));},ReplaceFirstWithFailure:function(cH){var cI,cM=this;cI=this.New(function(){var cK,cL;cK=cH.Build();cL=cM.U.Reactive.Drop(cK.State,1);return $.New(d,{Body:cK.Body,Dispose1:cK.Dispose1,Notify:cK.Notify,State:cM.U.Reactive.Concat(cM.U.Reactive.Return($.New(g,{$:1,$0:$.New(j,{$:0})})),cL)});});return cM.WithLayout(cH.get_Layout(),cI);},Return:function(cN){var cP=this;return this.New(function(){return $.New(d,{Body:cP.U.Reactive.Never(),Dispose1:function(cQ){return cQ;},Notify:function(){},State:cP.U.Reactive.Return($.New(g,{$:0,$0:cN}))});});},ReturnEmpty:function(cS){var cU=this;return this.New(function(){return $.New(d,{Body:cU.U.Reactive.Return(e.Delete()),Dispose1:function(cV){return cV;},Notify:function(){},State:cU.U.Reactive.Return($.New(g,{$:0,$0:cS}))});});},SelectMany:function(cX){var c0=this;return this.New(function(){var cZ,c1,c2,c4,c5,c6,c7,c8,c_,da;cZ=c0.BuildForm(cX);c1=c0.U.Reactive;c2=c1.Choose(cZ.State,function(c3){return c3.$==1?{$:0}:{$:1,$0:c0.BuildForm(c3.$0)};});c4=c0.U.Reactive;c5=c4.Heat(c2);c6=c0.U.Reactive;c7=cZ.Body;c8=c6.Select(c7,function(c9){return $.New(f,{$:1,$0:c9});});c_={contents:function(c$){return $.New(f,{$:1,$0:c$});}};da=function(db){return g.Sequence(db);};return $.New(d,{Body:c0.U.Reactive.Merge(c8,c0.U.Reactive.SelectMany(c0.U.Reactive.Select(c5,function(dc){var dd;dd=c_.contents;c_.contents=function(de){return $.New(f,{$:2,$0:dd(de)});};return c0.U.Reactive.Select(dc.Body,c_.contents);}))),Dispose1:function(){return cZ.Dispose1.call(null,null);},Notify:cZ.Notify,State:c0.U.Reactive.Select(c0.U.Reactive.CollectLatest(c0.U.Reactive.Select(c5,function(dg){return dg.State;})),da)});});},Sequence:function(dh){var di,dj,dk,dl,_do;di=i.ofSeq(dh);if(di.$==1){dj=di.$1;dk=di.$0;dl=this.Return(function(dm){return function(dn){return $.New(j,{$:1,$0:dm,$1:dn});};});_do=this.Sequence(dj);return this.Apply(this.Apply(dl,dk),_do);}else{return this.Return($.New(j,{$:0}));}},Switch:function(dp){var ds=this;return this.New(function(){var dr,dt,du,dv,dw,dy,dz;dr=ds.WithLayoutOrDefault(dp);dt=ds.ApplyLayout(dr);du=ds.BuildForm(dt);dv=ds.U.Reactive;dw=dv.Choose(du.State,function(dx){return dx.$==1?{$:0}:{$:1,$0:ds.BuildForm(dx.$0)};});dy=ds.U.Reactive;dz=dy.Heat(dw);return $.New(d,{Body:ds.U.Reactive.Concat(du.Body,ds.U.Reactive.Switch(ds.U.Reactive.Select(dz,function(dA){return dA.Body;}))),Dispose1:function(){return du.Dispose1.call(null,null);},Notify:du.Notify,State:ds.U.Reactive.Switch(ds.U.Reactive.Select(dz,function(dC){return dC.State;}))});});},WithCancelation:function(dD,dE){var dF,dJ,dK;dF=this.Return(function(dG){return function(dH){var dI;dI=[dG,dH];return dI[1].$==0?$.New(g,{$:0,$0:{$:0}}):dI[0].$==1?$.New(g,{$:1,$0:dI[0].$0}):$.New(g,{$:0,$0:{$:1,$0:dI[0].$0}});};});dJ=this.LiftResult(dD);dK=this.LiftResult(dE);return this.MapResult(function(dL){return g.Join(dL);},this.Apply(this.Apply(dF,dJ),dK));},WithLayout:function(dM,dN){return $.New(c,{Layout:dM,Build1:function(){return dN.Build();},Utils:this.U});},WithLayoutOrDefault:function(dP){return this.MapBody(function(dQ){return dQ;},dP);},WithNotification:function(dR,dS){var dT,dW=this;dT=this.New(function(){var dV;dV=dW.BuildForm(dS);return $.New(d,{Body:dV.Body,Dispose1:dV.Dispose1,Notify:function(dX){dV.Notify.call(null,dX);return dR(dX);},State:dV.State});});return dW.WithLayout(dS.get_Layout(),dT);},WithNotificationChannel:function(dY){var dZ,d4=this;dZ=this.New(function(){var d1,d2;d1=dY.Build();d2=function(d3){return[d3,d1.Notify];};return $.New(d,{Body:d1.Body,Dispose1:d1.Dispose1,Notify:d1.Notify,State:d4.U.Reactive.Select(d1.State,function(d5){return g.Map(d2,d5);})});});return d4.WithLayout(dY.get_Layout(),dZ);}},{New:function(d6){var d7;d7=$.New(this,{});d7.U=d6;d7.L=k.New({Reactive:d7.U.Reactive});return d7;}}),LayoutUtils:$.Class({Default:function(){return{Apply:function(){return{$:0};}};},Delay:function(d9){return{Apply:function(d_){return d9(null).Apply.call(null,d_);}};},New:function(d$){return{Apply:function(ea){var eb,ec;eb=d$(null);ec={contents:$.New(l,{$:0})};return{$:1,$0:[eb.Body,m.subscribeTo(ea,function(ed){var ee,ef;ee=e.ReplacedTree(ed,ec.contents);ec.contents=e.Apply(ed,ec.contents);ef=(e.Range(ed,ec.contents))[0];eb.Remove.call(null,ee.get_Sequence());return n.iteri(function(eg){return function(eh){return(eb.Insert.call(null,ef+eg))(eh);};},ed);})]};}};}},{New:function(){return $.New(this,{});}}),Result:$.Class({},{Apply:function(ej,ek){var el;el=[ej,ek];return el[0].$==1?el[1].$==1?$.New(g,{$:1,$0:i.append(el[0].$0,el[1].$0)}):$.New(g,{$:1,$0:el[0].$0}):el[1].$==1?$.New(g,{$:1,$0:el[1].$0}):$.New(g,{$:0,$0:el[0].$0.call(null,el[1].$0)});},Join:function(em){return em.$==1?$.New(g,{$:1,$0:em.$0}):em.$0;},Map:function(en,eo){return eo.$==1?$.New(g,{$:1,$0:eo.$0}):$.New(g,{$:0,$0:en(eo.$0)});},OfOption:function(ep){return ep.$==0?$.New(g,{$:1,$0:$.New(j,{$:0})}):$.New(g,{$:0,$0:ep.$0});},Sequence:function(eq){return n.fold(function(er){return function(es){var et,eu;if(er.$==1){et=er.$0;return es.$==1?$.New(g,{$:1,$0:i.append(et,es.$0)}):$.New(g,{$:1,$0:et});}else{eu=er.$0;return es.$==1?$.New(g,{$:1,$0:es.$0}):$.New(g,{$:0,$0:i.append(eu,i.ofArray([es.$0]))});}};},$.New(g,{$:0,$0:$.New(j,{$:0})}),eq);}}),Tree:{Apply:function(ev,ew){var ex;ex=function(ey,ez){var eA,eB,eC;if(ey.$==1){eA=ey.$0;if(ez.$==2){eB=ez.$1;return $.New(l,{$:2,$0:ex(eA,ez.$0),$1:eB});}else{return ex($.New(f,{$:1,$0:eA}),$.New(l,{$:2,$0:$.New(l,{$:0}),$1:ez}));}}else{if(ey.$==2){eC=ey.$0;return ez.$==2?$.New(l,{$:2,$0:ez.$0,$1:ex(eC,ez.$1)}):ex($.New(f,{$:2,$0:eC}),$.New(l,{$:2,$0:ez,$1:$.New(l,{$:0})}));}else{return ey.$0;}}};return ex(ev,ew);},Count:function(eD){var eE,eF,eG,eH,eI,eJ,eK,eL,eM;eE=[];eF=$.New(j,{$:0});eE[3]=eD;eE[2]=eF;eE[1]=0;eE[0]=1;while(eE[0]){if(eE[3].$==2){eG=eE[3].$0;eH=$.New(j,{$:1,$0:eE[3].$1,$1:eE[2]});eI=eE[1];eE[3]=eG;eE[2]=eH;eE[1]=eI;eE[0]=1;}else{eJ=eE[3];eK=eJ.$==0?0:1;if(eE[2].$==1){eL=eE[2].$1;eM=eE[1]+eK;eE[3]=eE[2].$0;eE[2]=eL;eE[1]=eM;eE[0]=1;}else{eE[0]=0;eE[1]=eE[1]+eK;}}}return eE[1];},DeepFlipEdit:function(eN){return eN.$==1?$.New(f,{$:2,$0:e.DeepFlipEdit(eN.$0)}):eN.$==2?$.New(f,{$:1,$0:e.DeepFlipEdit(eN.$0)}):$.New(f,{$:0,$0:eN.$0});},Delete:function(){return $.New(f,{$:0,$0:$.New(l,{$:0})});},Edit:$.Class({GetEnumerator:function(){return o.Get(this.get_Sequence());},GetEnumerator1:function(){return o.Get(this.get_Sequence());},get_Sequence:function(){return this.$==1?this.$0.get_Sequence():this.$==2?this.$0.get_Sequence():this.$0.get_Sequence();}}),FlipEdit:function(eO){return eO.$==1?$.New(f,{$:2,$0:eO.$0}):eO.$==2?$.New(f,{$:1,$0:eO.$0}):$.New(f,{$:0,$0:eO.$0});},FromSequence:function(eP){return n.fold(function(eQ){return function(eR){return $.New(l,{$:2,$0:eQ,$1:$.New(l,{$:1,$0:eR})});};},$.New(l,{$:0}),eP);},Range:function(eS,eT){var eU,eV,eW,eX,eY,eZ,e0,e1,e2;eU=[];eU[3]=0;eU[2]=eT;eU[1]=eS;eU[0]=1;while(eU[0]){if(eU[1].$==1){eV=eU[1].$0;if(eU[2].$==2){eW=eU[2].$0;eU[3]=eU[3];eU[2]=eW;eU[1]=eV;eU[0]=1;}else{eX=eU[3];eY=$.New(l,{$:0});eU[3]=eX;eU[2]=eY;eU[1]=eV;eU[0]=1;}}else{if(eU[1].$==2){eZ=eU[1].$0;if(eU[2].$==2){e0=eU[2].$1;eU[3]=eU[3]+e.Count(eU[2].$0);eU[2]=e0;eU[1]=eZ;eU[0]=1;}else{e1=eU[3]+e.Count(eU[2]);e2=$.New(l,{$:0});eU[3]=e1;eU[2]=e2;eU[1]=eZ;eU[0]=1;}}else{eU[0]=0;eU[1]=[eU[3],e.Count(eU[2])];}}}return eU[1];},ReplacedTree:function(e3,e4){var e5,e6;if(e3.$==1){e5=e3.$0;return e4.$==2?e.ReplacedTree(e5,e4.$0):e.ReplacedTree($.New(f,{$:1,$0:e5}),$.New(l,{$:2,$0:$.New(l,{$:0}),$1:e4}));}else{if(e3.$==2){e6=e3.$0;return e4.$==2?e.ReplacedTree(e6,e4.$1):e.ReplacedTree($.New(f,{$:2,$0:e6}),$.New(l,{$:2,$0:e4,$1:$.New(l,{$:0})}));}else{return e4;}}},Set:function(e7){return $.New(f,{$:0,$0:$.New(l,{$:1,$0:e7})});},ShowEdit:function(e8){var e9;e9=function(e_){return e_.$==1?"Left > "+e9(e_.$0):e_.$==2?"Right > "+e9(e_.$0):"Replace";};return e9(e8);},Transform:function(e$,fa){return fa.$==1?$.New(f,{$:1,$0:e.Transform(e$,fa.$0)}):fa.$==2?$.New(f,{$:2,$0:e.Transform(e$,fa.$0)}):$.New(f,{$:0,$0:e$(fa.$0)});},Tree:$.Class({GetEnumerator:function(){return o.Get(this.get_Sequence());},GetEnumerator1:function(){return o.Get(this.get_Sequence());},Map:function(fb){var fc;if(this.$==1){return $.New(l,{$:1,$0:fb(this.$0)});}else{if(this.$==2){fc=this.$1;return $.New(l,{$:2,$0:this.$0.Map(fb),$1:fc.Map(fb)});}else{return $.New(l,{$:0});}}},get_Sequence:function(){var fd;if(this.$==1){return[this.$0];}else{if(this.$==2){fd=this.$1;return n.append(this.$0.get_Sequence(),fd.get_Sequence());}else{return n.empty();}}}})},Validator:$.Class({Is:function(fe,ff,fg){return this.Validate(fe,ff,fg);},IsEmail:function(fh){var fj=this;return function(fi){return fj.IsRegexMatch("^[A-Za-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[A-Za-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\\.)+[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?$",fh,fi);};},IsEqual:function(fk,fl,fm){return this.Validate(function(fn){return p.Equals(fn,fk);},fl,fm);},IsFloat:function(fo){var fq=this;return function(fp){return fq.IsRegexMatch("^\\s*(\\+|-)?((\\d+(\\.\\d+)?)|(\\.\\d+))\\s*$",fo,fp);};},IsGreaterThan:function(fr,fs,ft){return this.Validate(function(fu){return p.Compare(fu,fr)===1;},fs,ft);},IsInt:function(fv){var fx=this;return function(fw){return fx.IsRegexMatch("^-?\\d+$",fv,fw);};},IsLessThan:function(fy,fz,fA){return this.Validate(function(fB){return p.Compare(fB,fy)===-1;},fz,fA);},IsNotEmpty:function(fC,fD){return this.Validate(function(fE){return fE!=="";},fC,fD);},IsNotEqual:function(fF,fG,fH){return this.Validate(function(fI){return!p.Equals(fI,fF);},fG,fH);},IsRegexMatch:function(fJ,fK,fL){var fN=this;return this.Validate(function(fM){return fN.VP.Matches(fJ,fM);},fK,fL);},IsTrue:function(fO,fP){return this.Validate(function(fQ){return fQ;},fO,fP);},Validate:function(fR,fS,fT){return fT.MapResult(function(fU){var fV;if(fU.$==1){return $.New(g,{$:1,$0:fU.$0});}else{fV=fU.$0;return fR(fV)?$.New(g,{$:0,$0:fV}):$.New(g,{$:1,$0:i.ofArray([fS])});}});}},{New:function(fW){var fX;fX=$.New(this,{});fX.VP=fW;return fX;}})}}}});$.OnInit(function(){a=$.Safe($$.IntelliFactory.Formlet);b=$.Safe(a.Base);c=$.Safe(b.Formlet);d=$.Safe(b.Form);e=$.Safe(b.Tree);f=$.Safe(e.Edit);g=$.Safe(b.Result);h=$.Safe($$.IntelliFactory.WebSharper);i=$.Safe(h.List);j=$.Safe(i.T);k=$.Safe(b.LayoutUtils);l=$.Safe(e.Tree);m=$.Safe(h.Util);n=$.Safe(h.Seq);o=$.Safe(h.Enumerator);return p=$.Safe(h.Unchecked);});$.OnLoad(function(){return;});}());
