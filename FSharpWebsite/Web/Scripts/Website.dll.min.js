(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;$.Define($$,{FSharpWebsite:{FSharpTweets:{Client:{checkNewTweets:function(){var q,r,_7;q=(r=function(){var t,u,v,w;t=a("#fsharpTweets");u=t.attr("data-tweet-id");v=c.Async("Website:2",[u]);w=function(x){var y,z,A,B,D,E,F,N,O,P,R,S,_1,_2,_5,_6;if(x.$==1){y=x.$0;z=(A=t.attr("data-tweets-count"),(B=function(C){return C<<0;},B(A)));D=(E=y[0],(F=$.Tupled(function(G){var H,I,J,K,L,M;H=G[0];I=G[1];J=G[2];K=G[3];L=G[4];M=G[5];return I;}),F(E)));N=(O=(P=function(Q){return Q.slice(0,Q.length).reverse();},P(y)),(R=(S=$.Tupled(function(T){var U,V,W,X,Y,Z;U=T[0];V=T[1];W=T[2];X=T[3];Y=T[4];Z=T[5];return f.makeTweetLi(U,V,W,X,Y,Z);}),function(_0){return g.map(S,_0);}),R(O)));_1=(_2=function(_3){return a("#tweetsList").prepend(_3.Body);},function(_4){return g.iter(_2,_4);});_1(N);_5=y.length;f.incrementTweetsCount(_5);f.setTweetId(D);f.toggleActionsVisibility();_6=_5===1?"1 new tweet":$$.String(_5)+" new tweets";f.displayInfoAlert(_6);return h.Return(null);}else{return h.Return(null);}};return h.Bind(v,w);},h.Delay(r));_7=function(_8){var _9;_9={$:0};return h.Start(_8);};return _7(q);},displayInfoAlert:function(_){var ba,bb,bc,bd,be,bf,bg;ba=j.add(k.Div(l.ofArray([k.Attr().Class("alert alert-info"),k.Id("alertDiv")])),l.ofArray([(bb=j.add(k.Button(l.ofArray([(bc=k.Attr(),bc.NewAttr("type","button")),k.Attr().Class("close"),(bd=m.Attr(),(be="data-"+"dismiss",bd.NewAttr(be,"alert")))])),l.ofArray([k.Text("Ã—")])),(bf=(bg=function(){return function(){return a("#alertDiv").remove();};},function(bi){return n.Events().OnClick(bg,bi);}),(bf(bb),bb))),j.add(k.P(l.ofArray([k.Attr().Class("centered")])),l.ofArray([k.Text(_)]))]));a("#navigation").append(ba.Body);return a("#alertDiv").show();},incrementTweetsCount:function(bj){var bk,bl,bm,bn,bp,bq,br;bk=a("#fsharpTweets");bl=(bm=bk.attr("data-tweets-count"),(bn=function(bo){return bo<<0;},bn(bm)));bp=(bq=bj+bl,(br=function(bs){return $$.String(bs);},br(bq)));return bk.attr("data-tweets-count",bp);},makeTweetLi:function(bt,bu,bv,bw,bx,by){var bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ;bz="https://twitter.com/"+bt;bA="https://twitter.com/intent/tweet?in_reply_to="+bu;bB="https://twitter.com/intent/retweet?tweet_id="+bu;bC="https://twitter.com/intent/retweet?tweet_id="+bu;bD=k.P($.New(o,{$:0}));bD.set_Html(bx);return j.add(k.LI(l.ofArray([k.Attr().Class("tweet")])),l.ofArray([j.add(j.add(k.A(l.ofArray([k.HRef(bz),k.Attr().Class("twitterProfileLink"),(bE=k.Attr(),bE.NewAttr("target","_blank"))])),l.ofArray([k.Img(l.ofArray([k.Src(bv),k.Alt(bw),k.Attr().Class("avatar"),k.Height("48"),k.Width("48")])),(bF=l.ofArray([k.Text(bw)]),(bG=k.Tags(),bG.NewTag("strong",bF)))])),l.ofArray([k.Text(" @"+bt)])),j.add((bH=l.ofArray([k.Attr().Class("pull-right")]),(bI=k.Tags(),bI.NewTag("small",bH))),l.ofArray([(bJ="("+by+")",k.Text(bJ))])),bD,j.add(k.Div(l.ofArray([k.Attr().Class("pull-right")])),l.ofArray([j.add(k.UL(l.ofArray([k.Attr().Class("tweetActions")])),l.ofArray([j.add(k.LI(l.ofArray([k.Attr().Class("tweetAction")])),l.ofArray([j.add(k.A(l.ofArray([k.HRef(bA)])),l.ofArray([k.Text("Reply")]))])),j.add(k.LI(l.ofArray([k.Attr().Class("tweetAction")])),l.ofArray([j.add(k.A(l.ofArray([k.HRef(bB)])),l.ofArray([k.Text("Retweet")]))])),j.add(k.LI(l.ofArray([k.Attr().Class("tweetAction")])),l.ofArray([j.add(k.A(l.ofArray([k.HRef(bC)])),l.ofArray([k.Text("Favorite")]))]))]))]))]));},setTweetId:function(bK){return a("#fsharpTweets").attr("data-tweet-id",bK);},toggleActionsVisibility:function(){var bL;bL=a(".tweet");bL.mouseenter(function(){return a(".tweetActions",this).css("visibility","visible");});return bL.mouseleave(function(){return a(".tweetActions",this).css("visibility","hidden");});},tweetsDiv:function(){var bO,bP,bR,bT,bU,bV,bW,cz,cA,cB;bO=k.UL(l.ofArray([k.Id("tweetsList")]));bP=p(function(bQ){bQ;return f.checkNewTweets();},60000);bR=function(bS){bS;};bR(bP);bT=(bU=k.Button(l.ofArray([k.Text("Load More"),k.Attr().Class("btn loadMore")])),(bV=(bW=function(bX){return function(){var bZ,b0,cv;bZ=(b0=function(){var b2,b3,b6,b7,b8,b9,b$,ca;b2=bX["HtmlProvider@32"];((b3=bX.Body,function(b4){return function(b5){return b2.SetAttribute(b3,b4,b5);};})("disabled"))("disabled");b6=a("#fsharpTweets");b7=(b8=b6.attr("data-tweets-count"),(b9=function(b_){return b_<<0;},b9(b8)));b$=c.Async("Website:1",[b7]);ca=function(cb){var cc,cd,ce,cn,co,cr,cs,ct;cc=(cd=(ce=$.Tupled(function(cf){var cg,ch,ci,cj,ck,cl;cg=cf[0];ch=cf[1];ci=cf[2];cj=cf[3];ck=cf[4];cl=cf[5];return f.makeTweetLi(cg,ch,ci,cj,ck,cl);}),function(cm){return g.map(ce,cm);}),cd(cb));cn=(co=function(cp){return bO.AppendI(cp);},function(cq){return g.iter(co,cq);});cn(cc);cr=cb.length;f.incrementTweetsCount(cr);f.toggleActionsVisibility();cs=bX["HtmlProvider@32"];(ct=bX.Body,function(cu){return cs.RemoveAttribute(ct,cu);})("disabled");return h.Return(null);};return h.Bind(b$,ca);},h.Delay(b0));cv=function(cw){var cx;cx={$:0};return h.Start(cw);};return cv(bZ);};},function(cy){return n.Events().OnClick(bW,cy);}),(bV(bU),bU)));cz=j.add(k.Div(l.ofArray([k.Id("tweetsDiv")])),l.ofArray([bO,bT]));cA=(cB=function(){var cD,cE,da;cD=(cE=function(){var cG,cH;cG=c.Async("Website:0",[]);cH=function(cI){var cJ,cK,cL,cT,cU,cV,c4,c5,c8,c9;cJ=(cK=cI[0],(cL=$.Tupled(function(cM){var cN,cO,cP,cQ,cR,cS;cN=cM[0];cO=cM[1];cP=cM[2];cQ=cM[3];cR=cM[4];cS=cM[5];return cO;}),cL(cK)));cT=(cU=(cV=$.Tupled(function(cW){var cX,cY,cZ,c0,c1,c2;cX=cW[0];cY=cW[1];cZ=cW[2];c0=cW[3];c1=cW[4];c2=cW[5];return f.makeTweetLi(cX,cY,cZ,c0,c1,c2);}),function(c3){return g.map(cV,c3);}),cU(cI));c4=(c5=function(c6){return bO.AppendI(c6);},function(c7){return g.iter(c5,c7);});c4(cT);f.incrementTweetsCount(20);f.setTweetId(cJ);c8=bT["HtmlProvider@32"];((c9=bT.Body,function(c_){return function(c$){return c8.SetCss(c9,c_,c$);};})("visibility"))("visible");f.toggleActionsVisibility();return h.Return(null);};return h.Bind(cG,cH);},h.Delay(cE));da=function(db){var dc;dc={$:0};return h.Start(db);};return da(cD);},function(dd){return j.OnAfterRender(cB,dd);});cA(cz);return cz;}},FsharpTweetsViewer:$.Class({get_Body:function(){return f.tweetsDiv();}})}}});$.OnInit(function(){a=$.Safe($$.jQuery);b=$.Safe($$.IntelliFactory.WebSharper);c=$.Safe(b.Remoting);d=$.Safe($$.FSharpWebsite);e=$.Safe(d.FSharpTweets);f=$.Safe(e.Client);g=$.Safe(b.Arrays);h=$.Safe(b.Concurrency);i=$.Safe(b.Html);j=$.Safe(i.Operators);k=$.Safe(i.Default);l=$.Safe(b.List);m=$.Safe(k.HTML5);n=$.Safe(i.EventsPervasives);o=$.Safe(l.T);return p=$.Safe($$.setInterval);});$.OnLoad(function(){});}());
